id: openstack_base

resources:
  - id: admin_tenant
    from: resources/keystone_tenant
    values:
      tenant_name: admin
      keystone_port: '{{keystone_port}}'
      keystone_host: '{{keystone_ip}}'
      admin_token: '{{admin_token}}'
      ip: '{{ip}}'
      ssh_user: '{{ssh_user}}'
      ssh_key: '{{ssh_key}}'

  - id: admin_user
    from: resources/keystone_user
    values:
      user_name: 'admin'
      user_password: 'admin'
      tenant_name: 'admin_tenant::tenant_name'
      keystone_port: '{{keystone_port}}'
      keystone_host: '{{keystone_ip}}'
      admin_token: '{{admin_token}}'
      ip: '{{ip}}'
      ssh_user: '{{ssh_user}}'
      ssh_key: '{{ssh_key}}'

  - id: keystone_service_endpoint
    from: resources/keystone_service_endpoint
    values:
     {% raw %}
      adminurl: 'http://{{keystone_ip}}:{{admin_port}}/v2.0'
      internalurl: 'http://{{keystone_ip}}:{{port}}/v2.0'
      publicurl: 'http://{{keystone_ip}}:{{port}}/v2.0'
     {% endraw %}
      description: 'OpenStack Identity Service'
      type: 'identity'
      admin_port: '{{keystone_port}}'
      port: '{{keystone_admin_port}}'
      keystone_port: '{{keystone_port}}'
      keystone_host: '{{keystone_ip}}'
      admin_token: '{{admin_token}}'
      ip: '{{ip}}'
      ssh_user: '{{ssh_user}}'
      ssh_key: '{{ssh_key}}'

  - id: service_tenant
    from: resources/keystone_tenant
    values:
      tenant_name: services
      keystone_port: '{{keystone_port}}'
      keystone_host: '{{keystone_ip}}'
      admin_token: '{{admin_token}}'
      ip: '{{ip}}'
      ssh_user: '{{ssh_user}}'
      ssh_key: '{{ssh_key}}'
